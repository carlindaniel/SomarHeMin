<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soma de Horas, Minutos e Segundos</title>
    <link rel="stylesheet" type="text/css" href="df.css">
</head>

<body>
    <audio id="som" src="som.mp3"></audio>
    <h1>Soma de Horas, Minutos e Segundos</h1>
    <p>Insira um valor no formato HH,MM;SS e clique em "Adicionar" para somar. O campo de segundos é opcional.</p>
    <input type="text" id="valorInput" placeholder="HH,MM;SS">
    <button onclick="adicionar()">Adicionar</button>
    <button onclick="copiarResultado()">Copiar Resultado</button>

    <p>Resultado:</p>
    <p id="resultado">0 horas 0 minutos 0 segundos</p>
    <div id="historico">
        <p>Últimos 3 valores adicionados:</p>
        <ul id="listaHistorico">
            <!-- Os valores serão adicionados aqui -->
        </ul>
    </div>
    <button onclick="limpar()">Limpar</button>
    
    <script>
        var totalHoras = 0;
        var totalMinutos = 0;
        var totalSegundos = 0;
        var historicoValores = []; // Array para armazenar os últimos 3 valores

        function adicionar() {
            var valorDigitado = document.getElementById('valorInput').value;

            // Use uma expressão regular para validar os diferentes formatos de entrada
            var regex = /^(\d{1,2})[;,](\d{1,2})[;,](\d{1,2})$|^(\d{1,2})[;,](\d{1,2})$|^(\d{1,2})[;,](\d{1,2})$|^(\d{1,2})$/;

            if (regex.test(valorDigitado)) {
                var partes = valorDigitado.split(/[;,]/);

                if (partes.length === 1) {
                    // Se houver 1 parte, assumimos que são minutos
                    totalMinutos += parseInt(partes[0], 10);
                } else if (partes.length === 2) {
                    // Se houver 2 partes, assumimos que são horas e minutos ou minutos e segundos
                    totalHoras += parseInt(partes[0], 10);
                    totalMinutos += parseInt(partes[1], 10);
                } else if (partes.length === 3) {
                    // Se houver 3 partes, assumimos que são horas, minutos e segundos
                    totalHoras += parseInt(partes[0], 10);
                    totalMinutos += parseInt(partes[1], 10);
                    totalSegundos += parseInt(partes[2], 10);
                }

                // Faça a correção dos minutos e segundos se excederem 60
                totalMinutos += Math.floor(totalSegundos / 60);
                totalSegundos = totalSegundos % 60;

                totalHoras += Math.floor(totalMinutos / 60);
                totalMinutos = totalMinutos % 60;

                // Adicione o valor atual ao histórico
                historicoValores.push(valorDigitado);
                if (historicoValores.length > 3) {
                    historicoValores.shift(); // Remova o valor mais antigo se houver mais de 3
                }
                atualizarResultado();
                atualizarHistorico();

                // Limpe o campo de entrada após adicionar
                document.getElementById('valorInput').value = "";

                // Reproduzir som ao adicionar
                var som = document.getElementById('som');
                som.play();
            } else {
                alert("Por favor, insira um valor válido no formato HH,MM;SS, HH,MM, MM;SS ou HH,MM;SS.");
            }
        }

        function copiarResultado() {
            var resultado = document.getElementById('resultado').textContent;
            // Create a temporary input element to copy the result
            var tempInput = document.createElement('input');
            document.body.appendChild(tempInput);
            tempInput.value = resultado;
            tempInput.select();
            document.execCommand('copy');
            document.body.removeChild(tempInput);
            alert('Resultado copiado para a área de transferência.');
        }

        function atualizarResultado() {
            var horasFormatadas = totalHoras.toString().padStart(2, '0');
            var minutosFormatados = totalMinutos.toString().padStart(2, '0');
            var segundosFormatados = totalSegundos.toString().padStart(2, '0');
            document.getElementById('resultado').textContent = horasFormatadas + " h " + minutosFormatados + " min " + segundosFormatados + " seg";
        }

        function atualizarHistorico() {
            var listaHistorico = document.getElementById('listaHistorico');
            listaHistorico.innerHTML = ""; // Limpe a lista

            for (var i = 0; i < historicoValores.length; i++) {
                var itemHistorico = document.createElement('li');
                itemHistorico.textContent = historicoValores[i];
                listaHistorico.appendChild(itemHistorico);
            }
        }

        function limpar() {
            totalHoras = 0;
            totalMinutos = 0;
            totalSegundos = 0;
            document.getElementById('valorInput').value = "";
            atualizarResultado();
            // Limpar também o histórico
            historicoValores = [];
            atualizarHistorico();

            // Reproduzir som ao limpar
            var som = document.getElementById('som');
            som.play();
        }
    </script>
</body>
</html>
